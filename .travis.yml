language: python
cache: pip
python: "3.7"
addons:
  postgresql: "11.8"
  apt:
    packages:
      - postgresql-11.8-postgis-2.5
env:
  global:
    - PYTHONPATH=.
    - ENVIRONMENT=test
    - PGPORT=5433
before_install:
  - pip install poetry
install:
  - poetry install -v
before_script:
  - psql -U postgres -c 'CREATE DATABASE mixed_beverages;'
  - psql -U postgres -c "CREATE EXTENSION postgis" -d template1
  - psql -U postgres -c "CREATE EXTENSION postgis_topology" -d template1
script:
  - make test
  - make lint
branches:
  only:
    - master
notifications:
  email: false
